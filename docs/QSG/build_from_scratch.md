# Build from scratch

The following instructions describe how to build DAOS 2.0 from source code. The following steps are required:

1. Download Source Code
2. Install Prerequisites
3. Build DAOS
4. Environment Setup

The approximate time to read and execute the steps on this guide is approximately 25 minutes per OS.

## Download Source Code

The DAOS repository is hosted on [GitHub](https://github.com/daos-stack/daos).

Download DAOS 2.0 source code using the following command:

```bash
git clone --recurse-submodules -b release/2.0 https://github.com/daos-stack/daos.git
cd daos
```

This command used above clones the DAOS git repository (path referred as ${daospath}
below) and initializes all the submodules automatically.

## Install Prerequisites

Building DAOS and its dependencies will require the installation of several
software packages on the system. Example: scons, libuuid, cmocka, ipmctl,
and several other packages are usually available on all the Linux
distributions. Moreover, a Go version of at least 1.10 is required.

Some DAOS tests use MPI. The DAOS build process uses the environment modules
package to detect the presence of MPI. If none is found, the build will skip
building those tests.

Scripts to install all the required packages are provided for each supported
distribution.

### openSUSE

For openSUSE, the following command should be executed as root or via sudo:

```bash
./utils/scripts/install-leap15.sh
```

### Unbuntu

As for Ubuntu, please run the following command as the root user or via sudo:

```bash
./utils/scripts/install-ubuntu20.sh
```

## Build DAOS

Once all prerequisites are installed, and the sources are downloaded,
DAOS can be built via the following command:

```bash
scons-3 --config=force --build-deps=yes install
```

By default, DAOS and its dependencies are installed under the `install`
directory. The installation path is modified by adding the PREFIX= option to
the above command line (e.g., PREFIX=/usr/local).

!!! note
    Several other parameters can be set, such as COMPILER=clang or
    COMPILER=icc on the scons command line. Please see `scons-3 --help` for
    all the possible options.

## Environment Setup

Once built, the environment may need to be modified to search for binaries
and header files in the installation path. This step is not required if
standard locations (e.g. /bin, /sbin, /usr/lib, ...) are used.

```bash
export CPATH=${daospath}/install/include/:$CPATH
export PATH=${daospath}/install/bin/:${daospath}/install/sbin:$PATH
```

If using bash, PATH can be set up for you after a build by sourcing the script
utils/sl/setup\_local.sh from the daos root. This script utilizes a file
generated by the build to determine the location of daos and its dependencies.

If required, ${daospath}/install must be replaced with the alternative path
specified through PREFIX.
