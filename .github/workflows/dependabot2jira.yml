# .github/workflows/dependabot2jira.yml
name: Dependabot_ticket

permissions: {}

on:
  push:
  pull_request:
    types: [opened, reopened, synchronize]

jobs:
  run-if-grom72:
    if: github.actor == 'grom72'
    runs-on: ubuntu-latest
    steps:
      - name: Echo PR info
        run: echo "PR created by grom72. Running workflow..."
      - name: Send request to Jira
        run: |
          curl -u "${{ secrets.JIRA_USERNAME }}:${{ secrets.JIRA_PASSWORD }}" \
            --insecure \
            -X POST \
            -H "Content-Type: application/json" \
            --data '{
              "fields": {
                "project": { "key": "PMDK" },
                "summary": "GitHub Actionâ€“generated ticket Wow",
                "description": "This issue was created via curl in GitHub Actions. Wow",
                "issuetype": { "name": "Bug" }
              }
            }' \
            https://${{ secrets.JIRA_HOST }}/rest/api/2/issue
